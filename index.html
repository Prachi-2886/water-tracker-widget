<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Water Tracker Widget</title>
    <style>
        body {
            font-family: "Poppins", sans-serif;
            padding: 20px;
            background: #0c1f18; /* darker blackish green background */
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 18px;
        }

        .card {
            display: flex;
            align-items: center;
            background: #153b2b; /* dark green card */
            border-radius: 18px;
            padding: 16px 20px;
            width: 300px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.45);
            gap: 18px;
        }

        .plant {
            font-size: 60px;
        }

        h2 {
            font-size: 21px;
            margin: 0;
            font-weight: 600;
        }

        .progressText {
            margin: 4px 0 10px;
            font-size: 19px;
            font-weight: 700;
            color: #e8ffe7;
        }

        .counter-box {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .btn {
            border: none;
            background: #0e261d;
            color: white;
            font-size: 20px;
            font-weight: 700;
            padding: 5px 13px;
            border-radius: 10px;
            cursor: pointer;
        }

        .btn:hover {
            background: #0a1b14;
        }
    </style>
</head>

<body>

    <!-- PRACHUU -->
    <div class="card">
        <div id="plant1" class="plant">üå±</div>
        <div>
            <h2>‚ú®‚Ä¢¬∞Prachuu¬∞‚Ä¢‚ú®</h2>
            <p id="progress1" class="progressText">0 / 8 glasses</p>
            <div class="counter-box">
                <button class="btn" onclick="removeWater1()">‚àí</button>
                <button class="btn" onclick="addWater1()">+</button>
            </div>
        </div>
    </div>

    <!-- AARYANN -->
    <div class="card">
        <div id="plant2" class="plant">üå±</div>
        <div>
            <h2>üçÄ‚Ä¢Aaryann‚Ä¢üçÄ</h2>
            <p id="progress2" class="progressText">0 / 8 glasses</p>
            <div class="counter-box">
                <button class="btn" onclick="removeWater2()">‚àí</button>
                <button class="btn" onclick="addWater2()">+</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBTecz188T94RYZ8gBb_Fw9zNDN4g5gyvo",
            authDomain: "prachuu-water-tracker.firebaseapp.com",
            projectId: "prachuu-water-tracker",
            storageBucket: "prachuu-water-tracker.firebasestorage.app",
            messagingSenderId: "14042922344",
            appId: "1:14042922344:web:190cc14f99c06999f3eadd",
            measurementId: "G-LS7D01MRE8"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const maxCups = 8;
        let cups1 = 0, cups2 = 0;
        const users = ["prachuu", "aaryann"];

        const todayStr = () => new Date().toISOString().split("T")[0];

        function update1() {
            document.getElementById("progress1").textContent = `${cups1} / ${maxCups} glasses`;
            const plant = document.getElementById("plant1");
            if (cups1 <= 1) plant.textContent = "üå±";
            else if (cups1 <= 4) plant.textContent = "üåø";
            else if (cups1 <= 7) plant.textContent = "üå≥";
            else plant.textContent = "üå∏";
        }

        function update2() {
            document.getElementById("progress2").textContent = `${cups2} / ${maxCups} glasses`;
            const plant = document.getElementById("plant2");
            if (cups2 <= 1) plant.textContent = "üå±";
            else if (cups2 <= 4) plant.textContent = "üåø";
            else if (cups2 <= 7) plant.textContent = "üå≥";
            else plant.textContent = "üå∏";
        }

        async function loadCounts() {
            for (let user of users) {
                const docRef = doc(db, "users", user, "water", todayStr());
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    if (user === "prachuu") cups1 = docSnap.data().count;
                    else cups2 = docSnap.data().count;
                } else {
                    await setDoc(docRef, { count: 0, date: todayStr() });
                }
            }
            update1();
            update2();
        }

        async function saveCount(user, count) {
            const docRef = doc(db, "users", user, "water", todayStr());
            await setDoc(docRef, { count: count, date: todayStr() });
        }

        window.addWater1 = async () => {
            if (cups1 < maxCups) cups1++;
            update1();
            await saveCount("prachuu", cups1);
        };

        window.removeWater1 = async () => {
            if (cups1 > 0) cups1--;
            update1();
            await saveCount("prachuu", cups1);
        };

        window.addWater2 = async () => {
            if (cups2 < maxCups) cups2++;
            update2();
            await saveCount("aaryann", cups2);
        };

        window.removeWater2 = async () => {
            if (cups2 > 0) cups2--;
            update2();
            await saveCount("aaryann", cups2);
        };

        await loadCounts();
    </script>

</body>

</html>
